document.addEventListener("DOMContentLoaded", () => {
  initLanguage();
});

function initLanguage() {
  const savedLang = localStorage.getItem("lang") || "en";
  setLanguage(savedLang);

  const toggleBtn = document.getElementById("langToggle");
  if (toggleBtn) {
    toggleBtn.addEventListener("click", () => {
      const currentLang = localStorage.getItem("lang") || "en";
      const newLang = currentLang === "en" ? "ar" : "en";
      setLanguage(newLang);
    });
  }
}

function setLanguage(lang) {
  localStorage.setItem("lang", lang);

  // تحديث كل العناصر التي تحتوي على data-translate
  document.querySelectorAll("[data-translate]").forEach(el => {
    const key = el.getAttribute("data-translate");
    if (translations[lang][key]) {
      el.textContent = translations[lang][key];
    }
  });

  // تحديث اتجاه الصفحة
  document.body.dir = lang === "ar" ? "rtl" : "ltr";
}

// قاموس الترجمات
const translations = {
  en: {
    loginTitle: "Login",
    emailPhone: "Email or Phone",
    password: "Password",
    role: "Role",
    manager: "Manager",
    supervisor: "Supervisor",
    delegate: "Delegate",
    loginBtn: "Login",
    forgotPassword: "Forgot password?",
    logout: "Logout",
    tasks: "Daily Tasks",
    clientName: "Client Name",
    address: "Address",
    visitTime: "Visit Time",
    status: "Status",
    inProgress: "In Progress",
    completed: "Completed",
    delayed: "Delayed",
    updateStatus: "Update Status",
    report: "Report",
    notes: "Notes",
    uploadImages: "Upload Images",
    clientSignature: "Client Signature",
    sendReport: "Send Report",
    map: "Map",
    notifications: "Notifications",
    dashboard: "Control Panel",
    performanceReports: "Reports & Analytics",
    attendance: "Attendance",
    addUser: "Add New User",
    fullName: "Full Name",
    submit: "Submit"
  },
  ar: {
    loginTitle: "تسجيل الدخول",
    emailPhone: "البريد الإلكتروني أو رقم الهاتف",
    password: "كلمة المرور",
    role: "الدور",
    manager: "مدير",
    supervisor: "مشرف",
    delegate: "مندوب",
    loginBtn: "دخول",
    forgotPassword: "نسيت كلمة المرور؟",
    logout: "تسجيل الخروج",
    tasks: "المهام اليومية",
    clientName: "اسم العميل",
    address: "العنوان",
    visitTime: "وقت الزيارة",
    status: "الحالة",
    inProgress: "قيد التنفيذ",
    completed: "مكتملة",
    delayed: "مؤجلة",
    updateStatus: "تحديث الحالة",
    report: "التقرير",
    notes: "ملاحظات",
    uploadImages: "رفع الصور",
    clientSignature: "توقيع العميل",
    sendReport: "إرسال التقرير",
    map: "الخريطة",
    notifications: "الإشعارات",
    dashboard: "لوحة التحكم",
    performanceReports: "التقارير والتحليلات",
    attendance: "الحضور والانصراف",
    addUser: "إضافة مستخدم جديد",
    fullName: "الاسم الكامل",
    submit: "إرسال"
  }
};
