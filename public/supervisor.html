<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù</title>
<script src="https://unpkg.com/@supabase/supabase-js"></script>
<style>
body{font-family:Arial;background:#f4f6f9;margin:0;}
header{background:#27ae60;color:white;padding:15px;text-align:center;position:relative;}
nav{background:#2c3e50;color:white;display:flex;justify-content:space-around;padding:10px;}
nav button{background:none;border:none;color:white;font-size:16px;cursor:pointer;}
nav button:hover{text-decoration:underline;}
.container{padding:20px;}
.card{background:white;border-radius:8px;padding:15px;margin-bottom:20px;box-shadow:0 3px 8px rgba(0,0,0,0.1);}
h3{margin-top:0;color:#2c3e50;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
table th,table td{border:1px solid #ddd;padding:8px;text-align:center;}
table th{background:#ecf0f1;}
.lang-btn{position:absolute;top:15px;left:15px;background:#2980b9;border:none;padding:8px 12px;border-radius:5px;cursor:pointer;color:white;}
</style>
</head>
<body>
<header>
<h2 id="title">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù</h2>
<button class="lang-btn" onclick="toggleLang()">ğŸ‡¸ğŸ‡¦/ğŸ‡¬ğŸ‡§</button>
</header>

<nav>
<button onclick="showSection('agents')">ğŸ‘¥ <span id="navAgents">Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†</span></button>
<button onclick="showSection('map')">ğŸ—º <span id="navMap">Ø§Ù„Ø®Ø±ÙŠØ·Ø©</span></button>
<button onclick="showSection('reports')">ğŸ“„ <span id="navReports">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span></button>
<button onclick="showSection('noti')">ğŸ”” <span id="navNoti">Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</span></button>
</nav>

<div class="container">
<div class="card" id="agents">
<h3 id="agentsTitle">Ù„ÙˆØ­Ø© Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†</h3>
<table>
<thead><tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th><th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‡Ø§Ù…</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th></tr></thead>
<tbody id="agentsList"></tbody>
</table>
</div>

<div class="card" id="map" style="display:none;">
<h3 id="mapTitle">Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†</h3>
<p>ğŸ“ Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ† Ù‡Ù†Ø§ (Google Maps API Ù„Ø§Ø­Ù‚Ù‹Ø§)</p>
</div>

<div class="card" id="reports" style="display:none;">
<h3 id="reportsTitle">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h3>
<table>
<thead><tr><th>Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</th><th>Ø§Ù„ØªÙ‚Ø±ÙŠØ±</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th></tr></thead>
<tbody id="reportsList"></tbody>
</table>
</div>

<div class="card" id="noti" style="display:none;">
<h3 id="notiTitle">Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h3>
<ul id="notiList"></ul>
</div>
</div>

<script>
const SUPABASE_URL="https://ncjxqfqwswwikedaffif.supabase.co";
const SUPABASE_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5janhxZnF3c3d3aWtlZGFmZmlmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc4NDEwNzQsImV4cCI6MjA3MzQxNzA3NH0.4G54968qAHyePjq9_ufSCSA1fHzx5XHFzOAqGKmVW18";
const supabase=supabase.createClient(SUPABASE_URL,SUPABASE_KEY);

let lang="ar";
const texts={
ar:{title:"Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù",nav:{agents:"Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†",map:"Ø§Ù„Ø®Ø±ÙŠØ·Ø©",reports:"Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±",noti:"Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"},agents:"Ù„ÙˆØ­Ø© Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†",map:"Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†",reports:"Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±",noti:"Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"},
en:{title:"Supervisor Dashboard",nav:{agents:"Agents",map:"Map",reports:"Reports",noti:"Notifications"},agents:"Agents Monitoring",map:"Agents Map",reports:"Review Reports",noti:"Notifications"}
};

function toggleLang(){
lang=lang==="ar"?"en":"ar";
document.documentElement.lang=lang;
document.documentElement.dir=lang==="ar"?"rtl":"ltr";
document.getElementById("title").innerText=texts[lang].title;
document.getElementById("navAgents").innerText=texts[lang].nav.agents;
document.getElementById("navMap").innerText=texts[lang].nav.map;
document.getElementById("navReports").innerText=texts[lang].nav.reports;
document.getElementById("navNoti").innerText=texts[lang].nav.noti;
document.getElementById("agentsTitle").innerText=texts[lang].agents;
document.getElementById("mapTitle").innerText=texts[lang].map;
document.getElementById("reportsTitle").innerText=texts[lang].reports;
document.getElementById("notiTitle").innerText=texts[lang].noti;
}

function showSection(section){
document.querySelectorAll(".card").forEach(c=>c.style.display="none");
document.getElementById(section).style.display="block";
}

async function loadAgents(){
const {data,error}=await supabase.from("users").select("*").eq("role","agent");
const tbody=document.getElementById("agentsList"); tbody.innerHTML="";
if(data){data.forEach(u=>{const tr=document.createElement("tr"); tr.innerHTML=`<td>${u.name}</td><td>${u.location}</td><td>${u.task_count||0}</td><td>${u.status||"Ù†Ø´Ø·"}</td>`; tbody.appendChild(tr);});}
}

async function loadReports(){
const {data}=await supabase.from("reports").select("*");
const tbody=document.getElementById("reportsList"); tbody.innerHTML="";
if(data) data.forEach(r=>{const tr=document.createElement("tr"); tr.innerHTML=`<td>${r.agent_name}</td><td>${r.notes}</td><td>${new Date(r.date).toLocaleDateString()}</td>`; tbody.appendChild(tr);});
}

async function loadNotifications(){
const {data}=await supabase.from("notifications").select("*");
const ul=document.getElementById("notiList"); ul.innerHTML="";
if(data) data.forEach(n=>{const li=document.createElement("li"); li.innerText=n.message; ul.appendChild(li);});
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
loadAgents(); loadReports(); loadNotifications();
</script>
</body>
</html>
