<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</title>
<link rel="stylesheet" href="css/style.css">
<script src="js/app.js" defer></script> <!-- Ù†Ø­ØªÙØ¸ Ø¨ÙƒÙ„ ÙˆØ¸Ø§Ø¦Ù app.js -->
<script defer>
  // ===================== Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙØ­Ø© =====================
  const translations = {
    ar: {
      tasks_title: "Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ©",
      report_title: "Ø±ÙØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±",
      report_notes: "Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª",
      send_report: "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±",
      map_title: "Ø§Ù„Ø®Ø±ÙŠØ·Ø©",
      update_location: "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆÙ‚Ø¹",
      notifications_title: "Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",
      tasks_tab: "Ø§Ù„Ù…Ù‡Ø§Ù…",
      report_tab: "Ø§Ù„ØªÙ‚Ø±ÙŠØ±",
      map_tab: "Ø§Ù„Ø®Ø±ÙŠØ·Ø©",
      notifications_tab: "Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",
      toggle_lang: "Ø¹Ø±Ø¨ÙŠ / English",
      delegate_name: "Ø£Ø­Ù…Ø¯ Ø¹Ù„ÙŠ"
    },
    en: {
      tasks_title: "Daily Tasks",
      report_title: "Submit Report",
      report_notes: "Write your notes",
      send_report: "Send Report",
      map_title: "Map",
      update_location: "Update Location",
      notifications_title: "Notifications",
      tasks_tab: "Tasks",
      report_tab: "Report",
      map_tab: "Map",
      notifications_tab: "Notifications",
      toggle_lang: "Arabic / English",
      delegate_name: "Ahmed Ali"
    }
  };

  // ===================== Ø§Ù„Ù„ØºØ© =====================
  function toggleLanguage() {
    const current = document.documentElement.lang;
    const newLang = current === "ar" ? "en" : "ar";
    document.documentElement.lang = newLang;
    document.documentElement.dir = newLang === "ar" ? "rtl" : "ltr";
    applyTranslations(newLang);
  }

  function applyTranslations(lang) {
    document.querySelectorAll("[data-translate]").forEach(el=>{
      const key = el.getAttribute("data-translate");
      if(translations[lang][key]) el.innerText = translations[lang][key];
    });
    updateDelegateHeader();
  }

  // ===================== Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ + Ø§Ù„Ø³Ø§Ø¹Ø© =====================
  function updateDelegateHeader() {
    const now = new Date().toLocaleTimeString("ar-EG", {
      hour: "2-digit", minute: "2-digit", hour12: false, timeZone: "Africa/Cairo"
    });
    const name = translations[document.documentElement.lang]["delegate_name"];
    const header = document.getElementById("delegate-name");
    if(header) header.innerText = `ğŸ‘¤ ${name} | ğŸ•’ ${now}`;
  }
  setInterval(updateDelegateHeader, 60000);

  // ===================== Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© =====================
  window.onload = function(){
    applyTranslations(document.documentElement.lang);

    // === Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙƒÙ„ ÙˆØ¸Ø§Ø¦Ù app.js Ø¨Ø¯ÙˆÙ† Ø­Ø°Ù Ø£ÙŠ Ø´ÙŠØ¡ ===
    if(typeof showSection === "function") showSection('tasks');
    if(typeof loadTasks === "function") loadTasks();
    if(typeof loadNotifications === "function") loadNotifications();
    if(typeof initMap === "function") initMap();

    updateDelegateHeader();
  };
</script>
</head>
<body>

<header class="app-header">
  <h1 id="delegate-name"></h1>
</header>

<section id="tasks" class="screen">
  <h2 data-translate="tasks_title">Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h2>
  <div id="tasks-list"></div>
</section>

<section id="report" class="screen">
  <h2 data-translate="report_title">Ø±ÙØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</h2>
  <textarea id="report-notes" placeholder="" data-translate="report_notes"></textarea><br>
  <input type="file" id="report-images" multiple><br>
  <input type="file" id="report-signature"><br>
  <button onclick="submitDelegateReport()" data-translate="send_report">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
</section>

<section id="map" class="screen">
  <h2 data-translate="map_title">Ø§Ù„Ø®Ø±ÙŠØ·Ø©</h2>
  <div id="map-container"></div>
  <button onclick="updateLocation()" data-translate="update_location">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
</section>

<section id="notifications" class="screen">
  <h2 data-translate="notifications_title">Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h2>
  <ul id="notifications-list"></ul>
</section>

<nav class="bottom-nav">
  <button id="btn-tasks" onclick="showSection('tasks')" data-translate="tasks_tab">Ø§Ù„Ù…Ù‡Ø§Ù…</button>
  <button id="btn-report" onclick="showSection('report')" data-translate="report_tab">Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
  <button id="btn-map" onclick="showSection('map')" data-translate="map_tab">Ø§Ù„Ø®Ø±ÙŠØ·Ø©</button>
  <button id="btn-notifications" onclick="showSection('notifications')" data-translate="notifications_tab">Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</button>
</nav>

<button class="lang-btn" onclick="toggleLanguage()" data-translate="toggle_lang">Ø¹Ø±Ø¨ÙŠ/English</button>

</body>
</html>
