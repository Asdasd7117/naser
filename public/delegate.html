<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ุดุงุดุฉ ุงูููุฏูุจ</title>
<link rel="stylesheet" href="css/style.css">
<script src="js/app.js" defer></script> <!-- ุงุณุชุฏุนุงุก app.js ููุท -->
<script defer>
  // ===================== ุงูุชุฑุฌูุงุช ุฏุงุฎู ุงูุตูุญุฉ =====================
  const translations = {
    ar: {
      tasks_title: "ุงูููุงู ุงูููููุฉ",
      report_title: "ุฑูุน ุงูุชูุฑูุฑ",
      report_notes: "ุฃุฏุฎู ุงูููุงุญุธุงุช",
      send_report: "ุฅุฑุณุงู ุงูุชูุฑูุฑ",
      map_title: "ุงูุฎุฑูุทุฉ",
      update_location: "ุชุญุฏูุซ ุงููููุน",
      notifications_title: "ุงูุฅุดุนุงุฑุงุช",
      tasks_tab: "ุงูููุงู",
      report_tab: "ุงูุชูุฑูุฑ",
      map_tab: "ุงูุฎุฑูุทุฉ",
      notifications_tab: "ุงูุฅุดุนุงุฑุงุช",
      toggle_lang: "ุนุฑุจู / English",
      delegate_name: "ุฃุญูุฏ ุนูู"
    },
    en: {
      tasks_title: "Daily Tasks",
      report_title: "Submit Report",
      report_notes: "Write your notes",
      send_report: "Send Report",
      map_title: "Map",
      update_location: "Update Location",
      notifications_title: "Notifications",
      tasks_tab: "Tasks",
      report_tab: "Report",
      map_tab: "Map",
      notifications_tab: "Notifications",
      toggle_lang: "Arabic / English",
      delegate_name: "Ahmed Ali"
    }
  };

  // ===================== ุงููุบุฉ =====================
  function toggleLanguage() {
    const current = document.documentElement.lang;
    const newLang = current === "ar" ? "en" : "ar";
    document.documentElement.lang = newLang;
    document.documentElement.dir = newLang === "ar" ? "rtl" : "ltr";
    applyTranslations(newLang);
  }

  function applyTranslations(lang) {
    document.querySelectorAll("[data-translate]").forEach(el=>{
      const key = el.getAttribute("data-translate");
      if(translations[lang][key]) el.innerText = translations[lang][key];
    });
    updateDelegateHeader();
  }

  // ===================== ุงุณู ุงูููุฏูุจ + ุงูุณุงุนุฉ =====================
  function updateDelegateHeader() {
    const now = new Date().toLocaleTimeString("ar-EG", {
      hour: "2-digit", minute: "2-digit", hour12: false, timeZone: "Africa/Cairo"
    });
    const name = translations[document.documentElement.lang]["delegate_name"];
    document.getElementById("delegate-name").innerText = `๐ค ${name} | ๐ ${now}`;
  }
  setInterval(updateDelegateHeader, 60000);

  // ===================== ุนูุฏ ุชุญููู ุงูุตูุญุฉ =====================
  window.onload = function(){
    applyTranslations(document.documentElement.lang);
    if(typeof tasks !== "undefined" && tasks.length>0) loadTasks(); // ุงุณุชุฎุฏุงู tasks ูู app.js
    if(typeof loadNotifications === "function") loadNotifications();
    if(typeof initMap === "function") initMap();
    updateDelegateHeader();
    showSection('tasks');
  };
</script>
</head>
<body>

<header class="app-header">
  <h1 id="delegate-name"></h1>
</header>

<section id="tasks" class="screen">
  <h2 data-translate="tasks_title">ุงูููุงู ุงูููููุฉ</h2>
  <div id="tasks-list"></div>
</section>

<section id="report" class="screen">
  <h2 data-translate="report_title">ุฑูุน ุงูุชูุฑูุฑ</h2>
  <textarea id="report-notes" placeholder="" data-translate="report_notes"></textarea><br>
  <input type="file" id="report-images" multiple><br>
  <input type="file" id="report-signature"><br>
  <button onclick="submitDelegateReport()" data-translate="send_report">ุฅุฑุณุงู ุงูุชูุฑูุฑ</button>
</section>

<section id="map" class="screen">
  <h2 data-translate="map_title">ุงูุฎุฑูุทุฉ</h2>
  <div id="map-container"></div>
  <button onclick="updateLocation()" data-translate="update_location">ุชุญุฏูุซ ุงููููุน</button>
</section>

<section id="notifications" class="screen">
  <h2 data-translate="notifications_title">ุงูุฅุดุนุงุฑุงุช</h2>
  <ul id="notifications-list"></ul>
</section>

<nav class="bottom-nav">
  <button id="btn-tasks" onclick="showSection('tasks')" data-translate="tasks_tab">ุงูููุงู</button>
  <button id="btn-report" onclick="showSection('report')" data-translate="report_tab">ุงูุชูุฑูุฑ</button>
  <button id="btn-map" onclick="showSection('map')" data-translate="map_tab">ุงูุฎุฑูุทุฉ</button>
  <button id="btn-notifications" onclick="showSection('notifications')" data-translate="notifications_tab">ุงูุฅุดุนุงุฑุงุช</button>
</nav>

<button class="lang-btn" onclick="toggleLanguage()" data-translate="toggle_lang">ุนุฑุจู/English</button>

</body>
</html>
