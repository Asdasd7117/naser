<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>الحسابات التفاعلية</title>
<script type="module">
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

const SUPABASE_URL = "https://ncjxqfqwswwikedaffif.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5janhxZnF3c3d3aWtlZGFmZmlmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc4NDEwNzQsImV4cCI6MjA3MzQxNzA3NH0.4G54968qAHyePjq9_ufSCSA1fHzx5XHFzOAqGKmVW18";
const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

const tbody = document.getElementById('usersList');
const errorDiv = document.getElementById('error');

// تحميل الحسابات وعرضها
async function loadUsers() {
  tbody.innerHTML = '';
  errorDiv.innerText = '';
  try {
    const { data: users, error } = await supabase.from('users').select('*');
    if(error){
      errorDiv.innerText = "خطأ عند تحميل الحسابات: " + error.message;
      return;
    }
    users.forEach(u => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${u.name || ''}</td>
        <td>${u.email}</td>
        <td>${u.phone || ''}</td>
        <td>${u.role}</td>
      `;
      tbody.appendChild(tr);
    });
  } catch(err) {
    errorDiv.innerText = "حدث خطأ: " + err.message;
  }
}

// زر التحديث
document.getElementById('refreshBtn').addEventListener('click', loadUsers);

// تحميل الحسابات عند فتح الصفحة
document.addEventListener('DOMContentLoaded', loadUsers);
</script>

<style>
body { font-family: Arial; background:#f0f4f7; margin:0; padding:20px; }
h2 { text-align:center; margin-bottom:20px; }
.container { max-width:900px; margin:0 auto; background:white; padding:20px; border-radius:12px; box-shadow:0 4px 8px rgba(0,0,0,0.1); }
table { width:100%; border-collapse:collapse; margin-top:20px; }
table th, table td { border:1px solid #ddd; padding:8px; text-align:center; }
table th { background:#f2f2f2; }
#error { color:red; text-align:center; margin-bottom:10px; }
button { padding:8px 12px; margin-top:10px; border:none; border-radius:5px; cursor:pointer; background:#007bff; color:white; }
button:hover { background:#0056b3; }
</style>
</head>
<body>
<div class="container">
<h2>الحسابات الحالية</h2>
<div id="error"></div>
<button id="refreshBtn">تحديث الحسابات</button>
<table>
<thead>
<tr><th>الاسم</th><th>البريد الإلكتروني</th><th>رقم الهاتف</th><th>الدور</th></tr>
</thead>
<tbody id="usersList"></tbody>
</table>
<p style="margin-top:20px; color:#555;">
ملاحظة: لإضافة حسابات جديدة، استخدم <strong>Supabase Dashboard → Authentication أو جدول users</strong>.
</p>
</div>
</body>
</html>
