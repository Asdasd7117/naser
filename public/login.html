<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
<script src="https://unpkg.com/@supabase/supabase-js"></script>
<style>
body{font-family:Arial;background:#f4f6f9;margin:0;padding:0;display:flex;justify-content:center;align-items:center;height:100vh;}
.container{background:white;padding:30px;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.2);width:350px;}
h2{text-align:center;color:#2c3e50;}
input,select{width:100%;padding:10px;margin:10px 0;border-radius:5px;border:1px solid #ccc;}
button{width:100%;padding:10px;background:#3498db;color:white;border:none;border-radius:5px;cursor:pointer;}
button:hover{background:#2980b9;}
.lang-btn{position:absolute;top:10px;right:10px;background:#2ecc71;color:white;border:none;padding:6px 10px;border-radius:5px;cursor:pointer;}
.error-msg{color:red;text-align:center;}
</style>
</head>
<body>
<button class="lang-btn" onclick="toggleLang()">ğŸ‡¸ğŸ‡¦/ğŸ‡¬ğŸ‡§</button>
<div class="container">
<h2 id="title">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
<select id="role">
<option value="agent">Ù…Ù†Ø¯ÙˆØ¨</option>
<option value="supervisor">Ù…Ø´Ø±Ù</option>
<option value="admin">Ù…Ø¯ÙŠØ±</option>
</select>
<input type="text" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ / Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
<input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
<button onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
<p class="error-msg" id="error"></p>
</div>

<script>
const SUPABASE_URL="https://ncjxqfqwswwikedaffif.supabase.co";
const SUPABASE_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5janhxZnF3c3d3aWtlZGFmZmlmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc4NDEwNzQsImV4cCI6MjA3MzQxNzA3NH0.4G54968qAHyePjq9_ufSCSA1fHzx5XHFzOAqGKmVW18";
const supabase=supabase.createClient(SUPABASE_URL,SUPABASE_KEY);

let lang="ar";
const texts={
ar:{title:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",email:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ / Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ",password:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",login:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",error:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©",roles:["Ù…Ù†Ø¯ÙˆØ¨","Ù…Ø´Ø±Ù","Ù…Ø¯ÙŠØ±"]},
en:{title:"Login",email:"Email / Phone",password:"Password",login:"Login",error:"Invalid credentials",roles:["Agent","Supervisor","Admin"]}
};

function toggleLang(){
lang=lang==="ar"?"en":"ar";
document.documentElement.lang=lang;
document.documentElement.dir=lang==="ar"?"rtl":"ltr";
document.getElementById("title").innerText=texts[lang].title;
document.getElementById("email").placeholder=texts[lang].email;
document.getElementById("password").placeholder=texts[lang].password;
document.querySelector("button").innerText=texts[lang].login;
const roleSelect=document.getElementById("role");
roleSelect.options[0].text=texts[lang].roles[0];
roleSelect.options[1].text=texts[lang].roles[1];
roleSelect.options[2].text=texts[lang].roles[2];
}

async function login(){
const email=document.getElementById("email").value;
const password=document.getElementById("password").value;
const role=document.getElementById("role").value;
const errorEl=document.getElementById("error");
errorEl.innerText="";

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Supabase
const {data,user,error}=await supabase
.from("users")
.select("*")
.eq("email",email)
.eq("role",role)
.single();

if(data && data.password===password){
switch(role){
case "agent": window.location.href="employee.html"; break;
case "supervisor": window.location.href="supervisor.html"; break;
case "admin": window.location.href="admin.html"; break;
}
}else{
errorEl.innerText=texts[lang].error;
}
}
</script>
</body>
</html>
