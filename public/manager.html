<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>شاشة المدير / الموارد البشرية</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="js/lang.js" defer></script>
  <script src="js/app.js" defer></script>
</head>
<body onload="showSection('reports'); loadReports(); loadAttendance(); loadTasksAdmin();">

  <!-- التقارير والتحليلات -->
  <section id="reports" class="screen">
    <h1 data-translate="reports_title">التقارير والتحليلات</h1>
    <table>
      <thead>
        <tr>
          <th data-translate="delegate_name">المندوب</th>
          <th data-translate="tasks_complete">المهام المكتملة</th>
          <th data-translate="tasks_pending">المهام المؤجلة</th>
          <th data-translate="completion_rate">نسبة الإنجاز</th>
        </tr>
      </thead>
      <tbody id="reports-table"></tbody>
    </table>
  </section>

  <!-- الحضور والانصراف -->
  <section id="attendance" class="screen">
    <h1 data-translate="attendance_title">الحضور والانصراف</h1>
    <div id="attendance-list"></div>
  </section>

  <!-- لوحة التحكم -->
  <section id="admin" class="screen">
    <h1 data-translate="admin_title">لوحة التحكم</h1>

    <h2 data-translate="add_task">إضافة / تعديل المهام</h2>
    <input type="text" id="task-client" placeholder="اسم العميل">
    <input type="text" id="task-address" placeholder="العنوان">
    <input type="time" id="task-time">
    <button onclick="addTask()" data-translate="add_task_btn">إضافة مهمة</button>

    <h2 data-translate="edit_delegate">تعديل بيانات المندوبين</h2>
    <input type="text" id="delegate-name" placeholder="اسم المندوب">
    <input type="text" id="delegate-phone" placeholder="رقم الهاتف">
    <input type="email" id="delegate-email" placeholder="البريد الإلكتروني">
    <button onclick="updateDelegate()" data-translate="update_delegate_btn">تحديث بيانات المندوب</button>

    <h2 data-translate="broadcast">إرسال إشعارات جماعية</h2>
    <textarea id="broadcast-message" placeholder="اكتب الرسالة هنا"></textarea>
    <button onclick="sendBroadcast()" data-translate="send_broadcast_btn">إرسال الإشعار</button>
  </section>

  <!-- شريط التنقل -->
  <nav class="bottom-nav">
    <button id="btn-reports" onclick="showSection('reports')" data-translate="reports_tab">التقارير</button>
    <button id="btn-attendance" onclick="showSection('attendance')" data-translate="attendance_tab">الحضور</button>
    <button id="btn-admin" onclick="showSection('admin')" data-translate="admin_tab">لوحة التحكم</button>
  </nav>

  <!-- زر اللغة -->
  <button class="lang-btn" onclick="toggleLanguage()" data-translate="toggle_lang">عربي/English</button>

  <script>
    function showSection(id) {
      document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
      document.querySelectorAll(".bottom-nav button").forEach(b => b.classList.remove("active"));
      document.getElementById(id).classList.add("active");
      document.getElementById("btn-" + id).classList.add("active");
    }

    // بيانات افتراضية للتقارير
    function loadReports() {
      const reports = [
        {delegate:"أحمد", complete:5, pending:2, percent:71},
        {delegate:"سعيد", complete:7, pending:1, percent:87}
      ];
      const tbody = document.getElementById("reports-table");
      tbody.innerHTML = "";
      reports.forEach(r=>{
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${r.delegate}</td><td>${r.complete}</td><td>${r.pending}</td><td>${r.percent}%</td>`;
        tbody.appendChild(tr);
      });
    }

    // بيانات افتراضية للحضور
    function loadAttendance() {
      const attendance = [
        {delegate:"أحمد", login:"09:00", logout:"17:00", deviation:"تأخير 10 دقائق"},
        {delegate:"سعيد", login:"08:45", logout:"17:00", deviation:"سليم"}
      ];
      const container = document.getElementById("attendance-list");
      container.innerHTML = "";
      attendance.forEach(a=>{
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `<strong>${a.delegate}</strong><br>دخول: ${a.login} - خروج: ${a.logout}<br>حالة: ${a.deviation}`;
        container.appendChild(div);
      });
    }

    // بيانات افتراضية لإدارة المهام
    function loadTasksAdmin() {
      console.log("جهز بيانات المهام للمسؤول");
    }

    function addTask() {
      alert("تم إضافة المهمة ✅");
    }

    function updateDelegate() {
      alert("تم تحديث بيانات المندوب ✅");
    }

    function sendBroadcast() {
      const msg = document.getElementById("broadcast-message").value;
      if(msg) alert("تم إرسال الإشعار: " + msg);
      else alert("أدخل رسالة قبل الإرسال!");
    }

    function toggleLanguage() {
      if (document.documentElement.lang === "ar") {
        document.documentElement.lang = "en";
        document.documentElement.dir = "ltr";
      } else {
        document.documentElement.lang = "ar";
        document.documentElement.dir = "rtl";
      }
      applyTranslations(); // استدعاء وظائف الترجمة من js/lang.js
    }
  </script>
</body>
</html>
