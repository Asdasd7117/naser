<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>تسجيل الدخول</title>
<link rel="stylesheet" href="assets/style.css">
</head>
<body>
<div class="login-container">
  <h2>تسجيل الدخول</h2>
  <label>اختر الدور</label>
  <select id="role">
    <option value="manager">المدير</option>
    <option value="supervisor">المشرف</option>
    <option value="employee">المندوب</option>
  </select>
  <label>البريد الإلكتروني / رقم الهاتف</label>
  <input type="text" id="email">
  <label>كلمة المرور</label>
  <input type="password" id="password">
  <button id="loginBtn">تسجيل الدخول</button>
  <div id="forgot">نسيت كلمة المرور؟</div>
</div>

<script src="https://unpkg.com/@supabase/supabase-js"></script>
<script>
const SUPABASE_URL = 'https://ncjxqfqwswwikedaffif.supabase.co';
const SUPABASE_KEY = 'ZX7giBBgWRScW6usplziAWjNYn9yCVeLVAQz7YUBjvA';
const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

document.getElementById('loginBtn').addEventListener('click', async ()=>{
  const role = document.getElementById('role').value;
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value.trim();
  if(!email || !password){ alert('يرجى إدخال جميع البيانات'); return; }

  // المدير ثابت
  if(role==='manager' && email==='7123456789' && password==='123456'){
    window.location.href='manager.html'; return;
  }

  const { data: users, error } = await supabase.from('users').select('*').eq('role',role).eq('email',email);
  if(error || users.length===0){ alert('بيانات الدخول غير صحيحة'); return; }

  if(users[0].password === password){
    if(role==='supervisor') window.location.href='supervisor.html';
    else window.location.href='employee.html';
  } else alert('بيانات الدخول غير صحيحة');
});
</script>
</body>
</html>
